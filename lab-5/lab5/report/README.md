# Отчет по лабораторной работе №5.
---

__Требования к проведению экспериментов и содержанию отчета
Зафиксируйте в отчете данные о текущей конфигурации операционной системы в 
аспекте управления памятью:__
+ Общий объем оперативной памяти.

![1](https://github.com/georgedem975/operating_systems/blob/master/lab-5/lab5/assets/1.png)
+ Объем раздела подкачки.

![2](https://github.com/georgedem975/operating_systems/blob/master/lab-5/lab5/assets/2.png)
+ Размер страницы виртуальной памяти.

![3](https://github.com/georgedem975/operating_systems/blob/master/lab-5/lab5/assets/3.png)
+ Объем свободной физической памяти в ненагруженной системе.

![4](https://github.com/georgedem975/operating_systems/blob/master/lab-5/lab5/assets/4.png)
+ Объем свободного пространства в разделе подкачки в ненагруженной 
системе.

![5](https://github.com/georgedem975/operating_systems/blob/master/lab-5/lab5/assets/5.png)


---

### Эксперимент №1.

##### ___Подготовительный этап___
Создайте скрипт mem.bash, реализующий следующий сценарий. Скрипт 
выполняет бесконечный цикл. Перед началом выполнения цикла создается пустой 
массив и счетчик шагов, инициализированный нулем. На каждом шаге цикла в 
конец массива добавляется последовательность из 10 элементов, например, (1 2 3 4 5 6 7 8 9 10). На каждом 100000-ом шаге в файл report.log добавляется строка с текущим значением размера массива (перед запуском скрипта файл обнуляется)

__Файл mem.bash__

```shell
#!/bin/bash

: > report.log

mass=(1 2 3 4 5 6 7 8 9 10)

arr=()

i=0

while :
do
        if [[ $(($i % 100000)) -eq 0 ]]; then
                echo ${#arr[@]} >> report.log
        fi
        for j in $mass
        do
                arr+=($j)
        done

        i=$(($i+1))
done
```

##### ___Первый этап___

__Задача__ – оценить изменения параметров, выводимых утилитой top в процессе работы созданного скрипта.

__Ход эксперимента:__
Запустите созданный скрипт mem.bash. Дождитесь аварийной остановки процесса и вывода в консоль последних сообщений системного журнала.

![6](https://github.com/georgedem975/operating_systems/blob/master/lab-5/lab5/assets/6.png)

Зафиксируйте в отчете последнюю запись журнала - значения параметров, с которыми произошла аварийная остановка процесса. Также зафиксируйте значение в последней строке файла report.log.

![7](https://github.com/georgedem975/operating_systems/blob/master/lab-5/lab5/assets/7.png)

Подготовьте две консоли. В первой запустите утилиту top. Во второй запустите скрипт и переключитесь на первую консоль. Убедитесь, что в ```top``` появился запущенный скрипт. Наблюдайте за следующими значениями (и фиксируйте их изменения во времени в отчете):
+ значения параметров памяти системы (верхние две строки над основной таблицей);
+ значения параметров в строке таблицы, соответствующей работающему скрипту;
+ изменения в верхних пяти процессах (как меняется состав и позиции этих процессов).

```
1m   1972 root      20   0  780612 561128   3020 R  93.8  30.2   3:58.95 sh
1m   1972 root      20   0  911952 692600   3020 R  97.9  37.2   4:57.76 sh
1m   1972 root      20   0 1045536 826184   3020 R  98.1  44.4   5:56.67 sh 
1m   1972 root      20   0 1178460 958976   3020 R  98.0  51.5   6:55.54 sh
1m   1972 root      20   0 1312836   1.0g   3020 R  98.1  58.8   7:54.49 sh
1m   1972 root      20   0 1445364   1.2g   3020 R  98.0  65.9   8:53.33 sh
1m   1972 root      20   0 1581192   1.3g   3020 R  98.2  73.2   9:52.29 sh
1m   1972 root      20   0 1714116   1.4g   3020 R  98.1  80.3  10:51.22 sh
1m   1972 root      20   0 1849680   1.5g   3008 R  97.9  85.5  11:50.05 sh
1m   1972 root      20   0 1984980   1.5g   2736 R  97.9  86.4  12:48.83 sh
1m   1972 root      20   0 2119092   1.2g   1404 R  96.6  69.7  13:46.88 sh
1m   1972 root      20   0 2238420   1.2g   1216 R  78.1  67.1  14:38.95 sh
1m   1972 root      20   0 2251620   1.2g      0 R  14.7  67.7  14:48.02 sh
1m   1972 root      20   0 2252148   1.2g      0 R   6.1  67.8  14:52.09 sh
1m   1972 root      20   0 2252676   1.2g      0 R   5.8  67.8  14:56.85 sh
1m   1972 root      20   0 2253072   1.2g     24 R   6.4  67.8  15:00.99 sh
1m   1972 root      20   0 2253072   1.2g      0 R   6.2  67.8  15:04.83 sh
1m   1972 root      20   0 2253336   1.2g    268 R   6.1  67.8  15:08.85 sh
1m   1972 root      20   0 2253468   1.2g      0 R   6.5  67.8  15:12.87 sh
1m   1972 root      20   0 2254524   1.2g     52 R   7.8  67.9  15:17.76 sh
1m   1972 root      20   0 2254788   1.2g      0 R   6.6  67.9  15:21.98 sh
1m   1972 root      20   0 2255052   1.2g      0 R   6.4  67.9  15:26.17 sh
1m   1972 root      20   0 2255316   1.2g      0 R   6.3  67.9  15:30.22 sh
1m   1972 root      20   0 2255316   1.2g      0 R   6.0  67.9  15:33.98 sh
1m   1972 root      20   0 2256768   1.2g      0 R   7.1  68.0  16:03.47 sh
```

![10](https://github.com/georgedem975/operating_systems/blob/master/lab-5/lab5/assets/10.png)

![11](https://github.com/georgedem975/operating_systems/blob/master/lab-5/lab5/assets/11.png)

![12](https://github.com/georgedem975/operating_systems/blob/master/lab-5/lab5/assets/12.png)

Проводите наблюдения и фиксируйте их в отчете до аварийной остановки процесса скрипта и его исчезновения из перечня процессов в ```top```.
Посмотрите с помощью команды ```dmesg | grep "mem.bash"``` последние две записи о скрипте в системном журнале и зафиксируйте их в отчете.

![8](https://github.com/georgedem975/operating_systems/blob/master/lab-5/lab5/assets/8.png)

Также зафиксируйте значение в последней строке файла ```report.log```.

![9](https://github.com/georgedem975/operating_systems/blob/master/lab-5/lab5/assets/9.png)

##### ___Второй этап___

__Задача__ – оценить изменения параметров, выводимых утилитой top в процессе работы нескольких экземпляров созданного скрипта.

__Ход эксперимента:__
Создайте копию скрипта, созданного на предыдущем этапе, в файл ```mem2.bash```. Настройте её на запись в файл ```report2.log.``` Создайте скрипт, который запустит немедленно друг за другом оба скрипта в фоновом режиме. 

__Файл mem2.bash__

```shell
#!/bin/bash

: > report2.log

mass=(1 2 3 4 5 6 7 8 9 10)

arr=()

i=0

while :
do
        if [[ $(($i % 100000)) -eq 0 ]]; then
                echo ${#arr[@]} >> report2.log
        fi
        for j in $mass
        do
                arr+=($j)
        done

        i=$(($i+1))
done
```

__Файл run.sh__

```shell
#!/bin/bash

./mem.bash &
./mem2.bash &
```

Подготовьте две консоли. В первой запустите утилиту top. Во второй запустите созданный перед этим скрипт и переключитесь на первую консоль. Убедитесь, что в top появились ```mem.bash``` и ```mem2.bash```. Наблюдайте за следующими значениями (и фиксируйте их изменения во времени в отчете):
+ значения параметров памяти системы (верхние две строки над основной таблицей);
+ значения параметров в строке таблицы, соответствующей работающему скрипту;
+ изменения в верхних пяти процессах (как меняется состав и позиции этих процессов).

```
2076 root      20   0  297756  78488   2964 R  52.9   4.2   0:32.74 mem2.bash
2075 root      20   0  297888  78468   2940 R  47.1   4.2   0:32.73 mem.bash
2075 root      20   0  366132 146580   2940 R  49.1   7.9   1:02.24 mem.bash
2076 root      20   0  366132 146600   2964 R  49.1   7.9   1:02.24 mem2.bash
2075 root      20   0  434508 214956   2940 R  49.1  11.6   1:31.75 mem.bash
2076 root      20   0  434772 215504   2964 R  49.1  11.6   1:31.75 mem2.bash
2075 root      20   0  502488 283068   2940 R  49.1  15.2   2:01.23 mem.bash
2076 root      20   0  502752 283352   2964 R  49.1  15.2   2:01.23 mem2.bash
2076 root      20   0  571128 351728   2964 R  49.1  18.9   2:30.74 mem2.bash
2075 root      20   0  570732 351180   2940 R  49.1  18.9   2:30.73 mem.bash
2075 root      20   0  638580 419028   2940 R  49.1  22.5   3:00.23 mem.bash
2076 root      20   0  639372 419840   2964 R  49.1  22.6   3:00.22 mem2.bash
2076 root      20   0  707616 488216   2964 R  49.1  26.2   3:29.73 mem2.bash
2075 root      20   0  706428 486876   2940 R  49.1  26.2   3:29.73 mem.bash
2075 root      20   0  773616 554196   2940 R  49.1  29.8   3:59.22 mem.bash
2076 root      20   0  774936 555536   2964 R  49.1  29.9   3:59.22 mem2.bash
2075 root      20   0  838296 618876   2940 R  49.0  33.3   4:28.66 mem.bash
2076 root      20   0  840144 620744   2964 R  49.0  33.4   4:28.66 mem2.bash
2076 root      20   0  906408 687008   2964 R  49.1  36.9   4:58.12 mem2.bash
2075 root      20   0  903900 684348   2940 R  48.8  36.8   4:57.97 mem.bash
2076 root      20   0  972408 753008   2964 R  49.0  40.5   5:27.57 mem2.bash
2075 root      20   0  969768 750348   2940 R  49.0  40.3   5:27.41 mem.bash
2075 root      20   0 1033392 791012   2940 R  48.8  42.5   5:56.72 mem.bash
2076 root      20   0 1036164 806380   2964 R  48.8  43.3   5:56.87 mem2.bash
2075 root      20   0 1099920 736072   2048 R  48.8  39.6   6:26.01 mem.bash
2076 root      20   0 1102560 845020   2060 R  48.8  45.4   6:26.16 mem2.bash
2076 root      20   0 1167504 840024   1752 R  49.1  45.1   6:55.64 mem2.bash
2075 root      20   0 1163676 756316   1736 R  48.5  40.6   6:55.12 mem.bash
2076 root      20   0 1232712 791980   1140 R  48.8  42.6   7:24.98 mem2.bash
2075 root      20   0 1228356 764928   1120 R  48.5  41.1   7:24.28 mem.bash
2076 root      20   0 1299504 760376   1048 R  48.8  40.9   7:54.30 mem2.bash
2075 root      20   0 1294884 762812   1024 R  48.8  41.0   7:53.58 mem.bash
2075 root      20   0 1348344 769832      0 R  39.7  41.4   8:17.62 mem.bash
2076 root      20   0 1353096 731076      0 R  39.5  39.3   8:18.27 mem2.bash
2076 root      20   0 1354680 732920    312 R   4.3  39.4   8:21.30 mem2.bash
2075 root      20   0 1349796 771260      0 R   4.0  41.4   8:20.48 mem.bash
2076 root      20   0 1355472 734116      0 R   4.1  39.5   8:23.93 mem2.bash
2075 root      20   0 1350588 771828      0 R   3.9  41.5   8:23.00 mem.bash
2075 root      20   0 1351512 772692      0 R   5.3  41.5   8:26.36 mem.bash
2076 root      20   0 1356528 735340      8 R   5.2  39.5   8:27.20 mem2.bash
2075 root      20   0 1361280 769944   1604 R  15.3  41.4   8:36.33 mem.bash
2075 root      20   0 1486416 895080   1604 R  97.8  48.1   9:35.19 mem.bash
2075 root      20   0 1618284   1.0g   1604 R  98.1  55.2  10:34.14 mem.bash
2075 root      20   0 1749756   1.1g   1604 R  98.1  62.2  11:33.04 mem.bash
2075 root      20   0 1880304   1.2g   1604 R  98.1  69.3  12:31.96 mem.bash
2075 root      20   0 2006100   1.3g   1604 R  97.8  76.0  13:30.73 mem.bash
2075 root      20   0 2132292   1.5g   1604 R  97.9  82.8  14:29.54 mem.bash
2075 root      20   0 2262312   1.5g   1604 R  97.8  86.1  15:28.30 mem.bash
2075 root      20   0 2388636   1.5g   1604 R  96.9  83.2  16:26.53 mem.bash
2075 root      20   0 2514564   1.5g   1548 R  97.3  84.6  17:24.97 mem.bash
2075 root      20   0 2629272   1.6g   1596 R  88.7  89.1  18:18.25 mem.bash
2075 root      20   0 2636928   1.6g      0 R  12.0  89.4  18:25.52 mem.bash
2075 root      20   0 2637192   1.6g      0 R   6.2  89.5  18:29.57 mem.bash
2075 root      20   0 2637324   1.6g      0 R   6.6  89.5  18:33.57 mem.bash
2075 root      20   0 2637588   1.6g     16 R   5.9  89.5  18:37.24 mem.bash
2075 root      20   0 2637984   1.6g      0 R   6.1  89.5  18:40.92 mem.bash
2075 root      20   0 2638512   1.6g      0 R   6.1  89.5  18:44.92 mem.bash
2075 root      20   0 2638776   1.6g     28 R   5.7  89.5  18:48.57 mem.bash
2075 root      20   0 2639040   1.6g      0 R   6.0  89.6  18:52.37 mem.bash
2075 root      20   0 2639568   1.6g      0 R   6.5  89.6  18:56.79 mem.bash
2075 root      20   0 2639964   1.6g     12 R   7.0  89.6  19:01.15 mem.bash
2075 root      20   0 2640360   1.6g      0 D   6.9  89.6  19:05.59 mem.bash
2075 root      20   0 2640756   1.6g    308 R   6.7  89.7  19:10.21 mem.bash
2075 root      20   0 2641020   1.6g     16 R   6.3  89.7  19:14.25 mem.bash
2075 root      20   0 2641680   1.6g      0 R   7.7  89.7  19:19.25 mem.bash
2075 root      20   0 2641944   1.6g      0 R   6.7  89.7  19:23.50 mem.bash
```

![13](https://github.com/georgedem975/operating_systems/blob/master/lab-5/lab5/assets/13.png)

![14](https://github.com/georgedem975/operating_systems/blob/master/lab-5/lab5/assets/14.png)

![15](https://github.com/georgedem975/operating_systems/blob/master/lab-5/lab5/assets/15.png)

![16](https://github.com/georgedem975/operating_systems/blob/master/lab-5/lab5/assets/16.png)

![17](https://github.com/georgedem975/operating_systems/blob/master/lab-5/lab5/assets/17.png)

![18](https://github.com/georgedem975/operating_systems/blob/master/lab-5/lab5/assets/18.png)

Проводите наблюдения и фиксируйте их в отчете до аварийной остановки последнего из двух скриптов и их исчезновения из перечня процессов в ```top```.
Посмотрите с помощью команды ```dmesg | grep "mem[2]*.bash"``` последние записи о скриптах в системном журнале и зафиксируйте их в отчете. Также зафиксируйте значения в последних строках файлов ```report.log``` и ```report2.log```.