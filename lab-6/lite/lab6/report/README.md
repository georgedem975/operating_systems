#  Отчет по лабораторной работе №6. (Консольный интерфейс ОС WINDOWS)

---
### Рассматриваемые вопросы

1. Познакомиться интерфейсом командной строки MS Windows.

2. Научится управлять основными объектами ОС MS Windows, используя командные файлы (скрипты).

### Подсказки

1. Работа может быть выполнена в любой версии ```MS Windows``` (от ```Windows XP``` и выше), но требует прав администратора для выполнения. Рекомендуется работать в виртуальной машины во избежание возможных повреждений конфигурации основной операционной системы.

2. Запуск командной строки осуществляется через меню ```пуск–выполнить–cmd```.

3. Рекомендуемые команды: ```cmd```, ```mem```, ```discpart```, ```cd```, ```md```, ```rd```, ```dir```, ```copy```, ```xcopy```, ```at```, ```sc```, ```find```, ```sort```, ```if```, ```call```. Приведенный список команд неполон, возможно использование других команд.

4. Перенаправление вывода в файл осуществляется с помощью символа ```>```.

5. ```Имя_команды /?``` позволяет получить справку по команде.

### Задание на лабораторную работу

1. ___Работа с файлами и директориями___
    * Создать каталог на диске ```С:\``` с именем ```LAB6```. В нем создать файлы с информацией о версии операционной системы, свободной и занятой памяти, жестких дисках, подключенных в системе. Имена файлов должны соответствовать применяемым для получения данных командам.

    ![1](https://github.com/georgedem975/operating_systems/blob/master/lab-6/lite/lab6/assets/1.png)

    ```
    C:\Users\user\Desktop\LAB6>systeminfo

    Имя узла:                         LAPTOP-OOHQ0NNA
    Название ОС:                      Майкрософт Windows 11 Домашняя для одного языка
    Версия ОС:                        10.0.22000 Н/Д построение 22000
    Изготовитель ОС:                  Microsoft Corporation
    Параметры ОС:                     Изолированная рабочая станция
    Сборка ОС:                        Multiprocessor Free
    Зарегистрированный владелец:      user
    Зарегистрированная организация:   Н/Д
    Код продукта:                     00327-30682-20082-AAOEM
    Дата установки:                   16.02.2022, 15:42:31
    Время загрузки системы:           30.11.2022, 18:26:44
    Изготовитель системы:             ASUSTeK COMPUTER INC.
    Модель системы:                   Strix GL504GV_GL504GV
    Тип системы:                      x64-based PC
    Процессор(ы):                     Число процессоров - 1.
                                  [01]: Intel64 Family 6 Model 158 Stepping 10 GenuineIntel ~2208 МГц
    Версия BIOS:                      American Megatrends Inc. GL504GV.307, 11.07.2019
    Папка Windows:                    C:\WINDOWS
    Системная папка:                  C:\WINDOWS\system32
    Устройство загрузки:              \Device\HarddiskVolume2
    Язык системы:                     ru;Русский
    Язык ввода:                       ru;Русский
    Часовой пояс:                     (UTC+03:00) Москва, Санкт-Петербург
    Полный объем физической памяти:   16 233 МБ
    Доступная физическая память:      7 216 МБ
    Виртуальная память: Макс. размер: 18 665 МБ
    Виртуальная память: Доступна:     5 420 МБ
    Виртуальная память: Используется: 13 245 МБ
    Расположение файла подкачки:      C:\pagefile.sys
    Домен:                            WORKGROUP
    Сервер входа в сеть:              \\LAPTOP-OOHQ0NNA
    Исправление(я):                   Число установленных исправлений - 6.
                                  [01]: KB5020617
                                  [02]: KB5007575
                                  [03]: KB5012170
                                  [04]: KB5014869
                                  [05]: KB5019961
                                  [06]: KB5017850
    Сетевые адаптеры:                 Число сетевых адаптеров - 4.
                                  [01]: VirtualBox Host-Only Ethernet Adapter
                                        Имя подключения: VirtualBox Host-Only Network
                                        DHCP включен:    Нет
                                        IP-адрес
                                        [01]: 192.168.56.1
                                        [02]: fe80::8c3c:3aee:c483:7bb6
                                  [02]: Realtek PCIe GbE Family Controller
                                        Имя подключения: Ethernet
                                        Состояние:       Носитель отключен
                                  [03]: Intel(R) Wireless-AC 9560 160MHz
                                        Имя подключения: Беспроводная сеть
                                        DHCP включен:    Да
                                        DHCP-сервер:     192.168.156.43
                                        IP-адрес
                                        [01]: 192.168.156.5
                                        [02]: fe80::cae3:a201:d92a:5fa8
                                  [04]: Kaspersky VPN
                                        Имя подключения: Подключение по локальной сети
                                        Состояние:       Носитель отключен
    Требования Hyper-V:               Расширения режима мониторинга виртуальной машины: Да
                                  Виртуализация включена во встроенном ПО: Да
                                  Преобразование адресов второго уровня: Да
                                  Доступно предотвращение выполнения данных: Да
    ```

    ![2](https://github.com/georgedem975/operating_systems/blob/master/lab-6/lite/lab6/assets/2.png)

    ![3](https://github.com/georgedem975/operating_systems/blob/master/lab-6/lite/lab6/assets/3.png)

    * Создать подкаталог ```TEST```, в него скопировать содержимое каталога ```LAB6```. Сделать этот каталог текущим.
    
    ```
    md TEST
    xcopy C:\Users\user\Desktop\LAB6 C:\Users\user\Desktop\LAB6\TEST
    ```

    * Создать одной командой файл с содержимым всех файлов каталога ```TEST```.

    ```
    copy /y /B C:\Users\user\Desktop\LAB6\TEST C:\Users\user\Desktop\LAB6\TEST\commands.txt
    ```

    * Удалить все файлы в текущем каталоге, кроме созданного последним.

    ```
    for %i in (*) do if not "%i"=="version.txt" del "%i"
    ```

    * Создать текстовый файл со списком использованных команд и параметрами, использованными для выполнения первых четырех подпунктов данного пункта.

2. ___Запуск и удаление процессов___

    * Узнать имя компьютера (хоста). Создать сетевой ресурс \\имя_хостового_компьютера\temp

    ![4](https://github.com/georgedem975/operating_systems/blob/master/lab-6/lite/lab6/assets/4.png)

    ![5](https://github.com/georgedem975/operating_systems/blob/master/lab-6/lite/lab6/assets/5.png)

    * Создать исполняемый файл, производящий копирование любого файла из дериктории C:\Windows объемом более 2 Мбайт на ресурс \\имя_хостового_компьютера\temp с поддержкой продолжения копирования при обрыве.

    ```
    forfiles /S /M *.* /C "cmd @file is C:\Users\user\Desktop\LAB6"
    ```

    * Настроить запуск исполняемого файла из предыдущего пункта по расписанию через 1 минуту.

    ```
    schtasks /create /tn Task2 /sc minute /tr "C:\Users\user\Desktop\LAB6\2_1.bat"
    ```

    * Проверить запуск копирования; если процесс появился, принудительно завершить его до его штатного завершения.

    * Сравнить исходный и конечный файл. Проверить их целостность.
    * Продолжить копирование с места разрыва.

    * Создать текстовый файл со списком использованных команд с параметрами, использованными для выполнения п.п. 2.1–2.6

3. ___Работа со службами___

    * Получить файл, содержащий список служб, запущенных в системе.

    ```
    net start > 1.txt
    ```

    * Создать командный файл обеспечивающий: 

        + остановку служб DNS-client; 

        ```
        net stop DNS-client
        ```

        + с временной задержкой, создание файла, содержащего обновленный список служб, запущенных в системе;

        ```
        net start > 2.txt
        ```

        + запуск другого командного файла, сравнивающего файлы, полученные в пп. 3.1 и 3.2, и создающего разностный файл;

        ```
        fc 1.txt 2.txt
        ```

        + восстановление работы служб.

        ```
        net start DNS-client
        ```

    * Создать текстовый файл со списком использованных команд и параметрами, использованными для выполнения пп. 3.1–3.2.

4. ___Поиск и сортировка информации в файлах___

    * Поместить список всех имен драйверов, загруженных в системе, в файл DRIVERS, в табличной форме.

    * Отсортировать полученные в п.п. 4.1 данные в обратном порядке по алфавиту.

    * Создать текстовый файл со списком использованных команд и параметрами, использованными для выполнения п.п. 4.1–4.2.

    ![6](https://github.com/georgedem975/operating_systems/blob/master/lab-6/lite/lab6/assets/6.png)